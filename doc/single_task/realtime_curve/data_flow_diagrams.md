# Real-time Curve Data Flow Diagrams

## Overview

This document provides comprehensive data flow diagrams for the NHEM real-time curve rendering system, showing the complete pipeline from data generation to visual display across all components.

## System Architecture Overview

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           NHEM REAL-TIME CURVE SYSTEM                           │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    │
│  │   Backend   │───►│   API Layer │───►│   Frontend  │    │  Python GUI │    │
│  │  (45 FPS)   │    │  (HTTP/WS)  │    │  (Canvas)   │    │ (Matplotlib)│    │
│  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘    │
│        │                   │                   │                   │           │
│        ▼                   ▼                   ▼                   ▼           │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    │
│  │   Data      │    │   JSON      │    │   Canvas    │    │   Matplotlib │    │
│  │ Processing │    │   Response  │    │ Rendering   │    │   Rendering   │    │
│  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 1. Backend Data Generation Pipeline

### 1.1 Main Processing Loop

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        MAIN PROCESSING LOOP (45 FPS)                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Start Loop (22.22ms interval)                                               │
│         │                                                                    │
│         ▼                                                                    │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Check ROI       │    │ Capture ROI      │    │ Fallback to     │           │
│  │ Configuration   │───►│ Data            │───►│ Simulated Data   │           │
│  │ (data_store)    │    │ (roi_capture)   │    │ (sin wave)       │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                    │                    │                       │
│         ▼                    ▼                    ▼                       │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Enhanced Peak   │    │ Store Frame      │    │ Broadcast       │           │
│  │ Detection       │───►│ (data_store)     │───►│ Data            │           │
│  │ (enhanced_       │    │                 │    │ (data_broad-    │           │
│  │  detector)      │    │                 │    │ caster)         │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                    │                    │                       │
│         ▼                    ▼                    ▼                       │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ API Response    │    │ WebSocket Push  │    │ Sleep Until     │           │
│  │ Generation      │    │ (60 FPS)        │    │ Next Frame      │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 Data Processing Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       DATA PROCESSING DETAIL                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  INPUT SIGNAL PROCESSING                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Signal Value    │───►│ Dynamic         │───►│ Slope Analysis   │           │
│  │ (ROI/Random)   │    │ Baseline        │    │ (Multiple       │           │
│  │                 │    │ Calculation     │    │ Methods)        │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                    │                    │                       │
│         ▼                    ▼                    ▼                       │
│  PEAK DETECTION PIPELINE                                                    │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Rising/Falling  │    │ Peak Region      │    │ Color           │           │
│  │ Edge Detection  │───►│ Identification   │───►│ Classification   │           │
│  │                 │    │                 │    │ (Green/Red)     │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                    │                    │                       │
│         ▼                    ▼                    ▼                       │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Quality Score   │    │ Peak Signal      │    │ Store in        │           │
│  │ Calculation     │───►│ Generation      │───►│ Circular Buffer  │           │
│  │                 │    │                 │    │ (Thread-Safe)   │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 2. API Layer Data Flow

### 2.1 HTTP API Request/Response Cycle

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       HTTP API DATA FLOW                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  CLIENT REQUEST                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Client         │───►│ HTTP Request     │───►│ FastAPI         │           │
│  │ (Frontend/     │    │ GET /data/real │    │ Route Handler   │           │
│  │ Python)        │    │ time?count=100  │    │ (routes.py)     │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  SERVER PROCESSING                                                        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Request         │    │ Authentication  │    │ Data Retrieval  │           │
│  │ Validation     │    │ (Public APIs)   │───►│ from DataStore   │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ ROI Capture     │    │ Response         │    │ JSON            │           │
│  │ (if configured)│    │ Formatting      │───►│ Serialization    │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  HTTP RESPONSE                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ HTTP 200 OK     │◄───│ JSON Response    │◄───│ Client Parse     │           │
│  │ + JSON Body    │    │                 │    │                 │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 WebSocket Real-time Streaming

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                   WEBSOCKET REAL-TIME STREAMING                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  CONNECTION SETUP                                                          │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Client Connect   │───►│ WebSocket Server │───►│ Password Auth    │           │
│  │ (Python/JS)     │    │ (socket_server)  │    │ Validation      │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  REAL-TIME BROADCASTING                                                     │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Data Broadcast  │◄───│ 60 FPS Loop      │◄───│ Client Receive   │           │
│  │ (data_broad-   │    │ (asyncio)        │    │ Updates         │           │
│  │ caster)         │    │                 │    │                 │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  MESSAGE FORMAT                                                           │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ JSON Message    │───►│ {               │───►│ Render Update   │           │
│  │ Structure       │    │ "type": "data",  │    │                 │           │
│  └─────────────────┘    │ "frame_count":  │    └─────────────────┘           │
│                                │ "current_value": │                                   │
│                                │ "peak_signal": 1,│                                   │
│                                │ ...             │                                   │
│                                │ }               │                                   │
│                                └─────────────────┘                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 3. Frontend Canvas Rendering Flow

### 3.1 Canvas Rendering Pipeline

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                       FRONTEND CANVAS RENDERING                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  DATA RECEPTION                                                            │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ HTTP Polling    │───►│ fetch()          │───►│ Response Parse   │           │
│  │ (50ms intervals)│    │ (50ms timeout)   │    │ JSON Transform  │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  DATA PROCESSING                                                          │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Validate Data   │───►│ Transform to     │───►│ Update App State │           │
│  │ Structure       │    │ Chart Format    │    │ appState.chart  │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  CANVAS RENDERING                                                         │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Clear Canvas    │───►│ Draw Grid        │───►│ Draw Waveform    │           │
│  │ (20 FPS)        │    │ (40-unit)       │    │ (Quadratic)     │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Draw Peaks      │    │ Draw Baseline    │    │ Request Frame   │           │
│  │ (Circles)       │    │ (Dashed Line)    │    │ Animation      │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Canvas Coordinate System

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        CANVAS COORDINATE SYSTEM                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  SCREEN PIXELS (800x400)                                                   │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ Y: 0 (Top)                                                            │   │
│  │           ┌─────────────────────────────────────────┐            │   │
│  │           │             CHART AREA                │            │   │
│  │           │   width=800px, height=400px            │            │   │
│  │           │                                         │            │   │
│  │           │  Y: 200 (Center) ── 100 value         │            │   │
│  │           │         ┌───────────────────────┐      │            │   │
│  │           │         │   0 value (min)     │      │            │   │
│  │           │         │                     │      │            │   │
│  │           │         │ 200 value (max)   │      │            │   │
│  │           │         └───────────────────────┘      │            │   │
│  │           │                                         │            │   │
│  │           │  Y: 400 (Bottom)                         │            │   │
│  │           └─────────────────────────────────────────┘            │   │
│  │                                                                           │   │
│  │  X: 0 (Left)───────────────────────────X: 800 (Right)                │   │
│  │                                                                           │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  COORDINATE TRANSFORMATION                                                    │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Data Value     │───►│ Clamp(0-200)    │───►│ Y = CenterY -     │           │
│  │ (110-130)      │    │ (Input Valid.)  │    │ (val-100)*scale │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Frame Index     │───►│ Calculate X      │───►│ X = index *     │           │
│  │ (0-N)          │    │ (Time)           │    │ stepX           │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 4. Python Client Matplotlib Flow

### 4.1 Matplotlib Rendering Pipeline

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                  PYTHON MATPLOTTLIB REAL-TIME PIPELINE                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ASYNC DATA MANAGER                                                        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Start Loop      │───►│ API Request      │───►│ JSON Parse       │           │
│  │ (20 FPS)        │    │ (aiohttp)       │    │ Validate Data   │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  DATA BUFFER MANAGEMENT                                                     │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Add to          │───►│ Remove Old      │───►│ Convert to      │           │
│  │ Deque          │    │ (if maxlen)      │    │ Numpy Arrays    │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                    │                    │                       │
│         ▼                    ▼                    ▼                       │
│  MATPLOTLIB UPDATE                                                        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ FuncAnimation  │───►│ Update Line      │───►│ Draw Canvas     │           │
│  │ Update Function │    │ (set_data)       │    │ (to Tkinter)   │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                │                                        │           │
│                                ▼                                        │           │
│  TKINTER DISPLAY                                                           │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ FigureCanvas    │───►│ Widget Embed     │───►│ GUI Update      │           │
│  │ Update          │    │ (tk.Frame)       │    │ (mainloop)      │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.2 Matplotlib Figure Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      MATPLOTLIB FIGURE STRUCTURE                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  MAIN FIGURE (10x6)                                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                 MAIN PLOT (0.75 height)                                 │   │
│  │  ┌─────────────────────────────────────────────────────────────┐     │   │
│  │  │ Y: 200 (Signal Range)                                        │     │   │
│  │  │      [Signal Line: #4ec9b0]                                   │     │   │
│  │  │      [Baseline: #dcdcaa (dashed)]                           │     │   │
│  │  │      [Peaks: Green #4ec9b0, Red #f48771]                    │     │   │
│  │  └─────────────────────────────────────────────────────────────┘     │   │
│  │                                                                         │   │
│  │                 ROI PLOT (0.25 height)                                  │   │
│  │  ┌─────────────────────────────────────────────────────────────┐     │   │
│  │  │ Y: 255 (Grayscale Range)                                      │     │   │
│  │  │      [ROI Signal: #569cd6]                                   │     │   │
│  │  └─────────────────────────────────────────────────────────────┘     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  DARK THEME CONFIGURATION                                                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Figure BG:      │    │ Axes BG:         │    │ Text Color:     │           │
│  │ #1e1e1e        │    │ #252526          │    │ #cccccc         │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 5. Complete End-to-End Data Flow

### 5.1 Full System Data Pipeline

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        COMPLETE END-TO-END DATA FLOW                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  TIME 0.0s    TIME 0.022s   TIME 0.044s   TIME 0.066s   TIME 0.088s        │
│     │              │              │              │              │         │
│     ▼              ▼              ▼              ▼              ▼         │
│                                                                             │
│  BACKEND (45 FPS)                                                          │
│  ┌──────┐      ┌──────┐      ┌──────┐      ┌──────┐      ┌──────┐      │
│  │Gen  │      │Gen  │      │Gen  │      │Gen  │      │Gen  │      │
│  │Signal│      │Signal│      │Signal│      │Signal│      │Signal│      │
│  │127.0 │      │127.5 │      │128.0 │      │128.5 │      │129.0 │      │
│  │Peak:0│      │Peak:0│      │Peak:1│      │Peak:0│      │Peak:0│      │
│  └──▲──┘      └──▲──┘      └──▲──┘      └──▲──┘      └──▲──┘      │
│     │              │              │              │              │         │
│     └──────────────┼──────────────┼──────────────┼──────────────┘         │
│                   STORE IN CIRCULAR BUFFER (max 100 frames)               │
│                                                                             │
│  API LAYER                                                               │
│  ┌─────────────────────────────────────────────────────────────────────┐ │
│  │ HTTP GET /data/realtime?count=100                              │ │
│  │ Returns:                                                                │ │
│  │ {                                                                       │ │
│  │   "series": [{"t": 0.0, "value": 127.0}, ...],                   │ │
│  │   "peak_signal": 1,                                                 │ │
│  │   "enhanced_peak": {"color": "green", "confidence": 0.95}          │ │
│  │ }                                                                       │ │
│  └─────────────────────────────────────────────────────────────────────┘ │
│                   │                                                   │
│                   ▼                                                   │
│  CLIENTS (20 FPS)                                                         │
│  ┌─────────────────────┬─────────────────────┬─────────────────────┐     │
│  │ FRONTEND CANVAS    │ PYTHON MATPLOTTLIB  │ WEBSOCKET CLIENT   │     │
│  │                    │                    │                    │     │
│  │ fetch() every 50ms  │ aiohttp every 50ms │ ws.onmessage       │     │
│  │                    │                    │                    │     │
│  │ Render at 20 FPS   │ Update at 20 FPS   │ Receive at 60 FPS   │     │
│  │                    │                    │                    │     │
│  │ VS Code Theme      │ Dark Theme          │ Native GUI          │     │
│  └─────────────────────┴─────────────────────┴─────────────────────┘     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 5.2 Data Transformation Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      DATA TRANSFORMATION PIPELINE                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  BACKEND DATA                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Raw Signal      │    │ Peak Detection   │    │ Metadata         │           │
│  │ 127.45          │    │ signal: 1        │    │ frame_count: 125 │           │
│  │                 │    │ color: green     │    │ timestamp: ...   │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                    │                    │                       │
│         ▼                    ▼                    ▼                       │
│  SERIALIZATION                                                            │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ JSON Encoding    │    │ Pydantic Model   │    │ HTTP Response    │           │
│  │ (Python)         │    │ Validation        │    │ (FastAPI)       │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                    │                    │                       │
│         ▼                    ▼                    ▼                       │
│  NETWORK TRANSFER                                                        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ HTTP/1.1         │    │ 200 OK          │    │ Response Body    │           │
│  │ Text/JSON        │    │ 2.3KB           │    │ Transmission    │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                    │                    │                       │
│         ▼                    ▼                    ▼                       │
│  CLIENT PROCESSING                                                         │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ JSON Parse       │    │ Transform to     │    │ Update State     │           │
│  │ (JavaScript/    │    │ Chart Format     │    │ appState.chart   │           │
│  │  Python)         │    │ [{t, value},..]   │                    │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                    │                    │                       │
│         ▼                    ▼                    ▼                       │
│  VISUAL RENDERING                                                         │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Canvas 2D         │    │ Matplotlib       │    │ WebSocket       │           │
│  │ Coordinates      │    │ Figure Update    │    │ Native Render    │           │
│  │ (Pixel Mapping)   │    │ (Lines/Markers)   │                    │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 6. Performance Optimization Flow

### 6.1 Performance Pipeline

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        PERFORMANCE OPTIMIZATION PIPELINE                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  BACKEND OPTIMIZATION                                                        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Precise Timing   │    │ Circular Buffer   │    │ Thread-Safe      │           │
│  │ (perf_counter)   │    │ (No Memory Leak)  │    │ Lock Granularity)│           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         45 FPS              22.22ms            <60KB memory        Minimal contention   │
│                                                                             │
│  NETWORK OPTIMIZATION                                                        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ HTTP Keep-Alive  │    │ Response Cache    │    │ Timeout Control   │           │
│  │ (Connection Reuse)│    │ (If Available)   │    │ (5s Default)     │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         ~1ms latency        ~200ms savings     Prevent Hangs      │           │
│                                                                             │
│  FRONTEND OPTIMIZATION                                                       │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Request Animation│    │ Double Buffer     │    │ Hardware Accel   │           │
│  │ (requestIdle)   │    │ (Implicit Canvas) │    │ (GPU)            │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         20 FPS              ~16ms render        ~2-5ms render      │           │
│                                                                             │
│  PYTHON OPTIMIZATION                                                        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Deque Buffers    │    │ Numpy Arrays      │    │ Blit Rendering   │           │
│  │ (O(1) ops)      │    │ (Vectorized)       │    │ (Fast Updates)    │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         20 FPS              <1ms processing     ~3-8ms render     │           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 6.2 Memory Management Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          MEMORY MANAGEMENT STRATEGY                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  CIRCULAR BUFFER MANAGEMENT                                                   │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ Frame Index:     │ Frame Index:     │ Frame Index:     │ Frame Index:     │   │
│  │ 0, 1, 2, 3...    │ 0, 1, 2, 3...    │ 0, 1, 2, 3...    │ 0, 1, 2, 3...    │   │
│  │                │                │                │                │   │
│  │ [127.0]         │ [127.5]         │ [128.0]         │ [128.5]         │   │
│  │ Peak:0         │ Peak:0         │ Peak:1         │ Peak:0         │   │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘   │
│         ▼                    ▼                    ▼                    ▼         │
│  BUFFER FULL (max_size = 100)                                                    │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Frame Index:     │ Frame Index:     │ Frame Index:     │           │
│  │ 1, 2, 3, 4...    │ 1, 2, 3, 4...    │ 1, 2, 3, 4...    │           │
│  │                │                │                │                │           │
│  │ [127.5]         │ [128.0]         │ [128.5]         │           │
│  │ Peak:0         │ Peak:1         │ Peak:0         │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         │                │                │                │           │
│  NEW DATA (oldest shifted):                                                  │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Frame Index:     │ Frame Index:     │ Frame Index:     │           │
│  │ 2, 3, 4, 5...    │ 2, 3, 4, 5...    │ 2, 3, 4, 5...    │           │
│  │                │                │                │                │           │
│  │ [128.0]         │ [128.5]         │ [129.0]         │           │
│  │ Peak:0         │ Peak:0         │ Peak:0         │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│         ▼                │                │                │           │
│  CONTINUOUS                                                                │
│  Constant Memory Usage ~60KB (100 frames * 64 bytes each)               │
│                                                                             │
│  CLIENT SIDE BUFFER MANAGEMENT                                              │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Frontend:       │ Python Client:    │ WebSocket:       │           │
│  │ JavaScript      │ Python Deques     │ Client State     │           │
│  │ Arrays           │ Numpy Arrays      │ Native Memory     │           │
│  │                 │                 │                 │           │
│  │ maxPoints=500   │ maxPoints=1000   │ Variable Size     │           │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘           │
│     ~8KB                 ~80KB               ~2-5MB              │           │
│                                                                             │
│  TOTAL SYSTEM MEMORY                                                         │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐           │
│  │ Backend Server    │ Frontend Browser  │ Python GUI        │           │
│  │ ~2MB            │ ~10MB            │ ~50MB             │           │
│  │ (Process +     │ (Page + Data)    │ (App + Plots)     │           │
│  │  Buffers)        │                  │                  │           │
│  └─────────────────┘    └─────────────────�    └─────────────────┘           │
│         TOTAL: ~62MB SYSTEM-WIDE (excluding overheads)                         │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

These comprehensive data flow diagrams illustrate the complete real-time curve rendering system, from data generation in the backend through API transport to final visualization in multiple client types, with detailed performance and memory optimization strategies.